#
# Example YAML for flow.ci
#

# Built-in environment variables
#
# FLOWCI_SERVER_URL:
#
# FLOWCI_FLOW_NAME:
# FLOWCI_FLOW_WEBHOOK:
#
# FLOWCI_JOB_BUILD_NUM:
# FLOWCI_JOB_STATUS:
# FLOWCI_JOB_TRIGGER:

# envs:
#  environment variables in flow level which can be used in every steps
envs:
  # Define Flow level variables
  EXAMPLE_VAR: "Hi, I'am an example YAML"
  
steps:
  - name: run script
    envs:
      SAY_HELLO: "hello.flow.ci"
    allow_failure: true
    script: |
      echo ${SAY_HELLO} ${EXAMPLE_VAR}
      sleep 1
  
  - name: build in envs
    script: |
      echo "Server URL = ${FLOWCI_SERVER_URL}"
      echo "Ttoken = ${FLOWCI_AGENT_TOKEN}"
      echo "Port = ${FLOWCI_AGENT_PORT}"
      echo "Workspace = ${FLOWCI_AGENT_WORKSPACE}"
      echo "Current job dir = ${FLOWCI_AGENT_JOB_DIR}"
      echo "Plugin dir = ${FLOWCI_AGENT_PLUGIN_DIR}"
      
  - name: run from docker
    envs:
      COND_VAR: "hello"
    condition: |
      return "$COND_VAR" == "hello"
    docker:
      image: golang:1.12
    script: |
      go get github.com/golang/example/hello
      $GOPATH/bin/hello
