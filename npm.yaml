#
# NPM Project Template
#

envs:
  FLOWCI_GIT_URL: "https://github.com/hexojs/hexo.git"
  FLOWCI_GIT_BRANCH: "master"

steps:
- name: clone
  docker:
    image: flowci/debian-git
  plugin: 'gitclone'

- name: install
  docker:
    image: node:12
  envs:
    NPM_CMD: "npm install"
  plugin: 'npm-runner'

- name: lint
  docker:
    image: node:12
  envs:
    NPM_CMD: "npm run eslint"
  plugin: 'npm-runner'

- name: test
  docker:
    image: node:12
  envs:
    NPM_CMD: "npm run test-cov"
  plugin: 'npm-runner'

- name: gen-report
  docker:
    image: node:12
  envs:
    NPM_CMD: "nyc report --reporter=html"
  plugin: 'npm-runner'

- name: report upload
  docker:
    image: ubuntu:18.04
  envs:
    REPORT_PATH: "${FLOWCI_GIT_REPO}/coverage"
    REPORT_NAME: "Code Coverage"
  plugin: 'report-upload'